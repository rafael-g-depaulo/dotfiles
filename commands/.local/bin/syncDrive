#!/bin/bash

rcloneDriveRemoteName="drive"
syncNetworkThrottle="10M"

while read -r line; do
	driveFolderName=$(echo $line | jq -r '.name')
	localFolderPath=$(echo $line | jq -r '.path')

	echo "syncing folder \"$(basename "$localFolderPath")\""
	echo "   with remote folder \"$driveFolderName\""

	rclone bisync -n "$localFolderPath" "$rcloneDriveRemoteName:$driveFolderName" --bwlimit $syncNetworkThrottle >/dev/null

done < <(raganConfig | jq -c '.drives[]')

echo "all done!"
